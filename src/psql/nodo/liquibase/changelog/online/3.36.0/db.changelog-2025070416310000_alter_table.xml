<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog
	xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">
	
	        <changeSet author="liquibase" id="202507081512" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="V_POSITION_TRANSFER"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081513" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="V_RT_VERSAMENTI"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081514" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="V_PM_SESSION_DATA"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081515" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="V_RT"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081516" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="V_RPT_VERSAMENTI"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081517" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="V_RPT"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081518" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="PM_SESSION_DATA"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081519" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="RPT_VERSAMENTI"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081520" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="RT"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081530" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="RPT"/>
    </changeSet>

    <changeSet author="liquibase" id="202507081540" >
        <dropView 
        schemaName="${schemaOffline}"
        viewName="RT_VERSAMENTI"/>
    </changeSet>

	<changeSet author="liquibase" id="20250704163900">
		<modifyDataType schemaName="${schema}"
			tableName="position_transfer" columnName="amount"
			newDataType="numeric" />
	</changeSet>

	<changeSet author="liquibase" id="20250704163910">
		<modifyDataType schemaName="${schema}"
			tableName="pm_session_data" columnName="importo_totale_pagato"
			newDataType="numeric" />
		<modifyDataType schemaName="${schema}"
			tableName="pm_session_data" columnName="commissione"
			newDataType="numeric" />
	</changeSet>

	<changeSet author="liquibase" id="20250704163920">
		<modifyDataType schemaName="${schema}" tableName="rpt"
			columnName="somma_versamenti" newDataType="numeric" />
	</changeSet>

	<changeSet author="liquibase" id="20250704163930">
		<modifyDataType schemaName="${schema}"
			tableName="rpt_versamenti" columnName="importo"
			newDataType="numeric" />
		<modifyDataType schemaName="${schema}"
			tableName="rpt_versamenti" columnName="commissione_carico_pa"
			newDataType="numeric" />
	</changeSet>


	<changeSet author="liquibase" id="20250704163940">
		<modifyDataType schemaName="${schema}" tableName="rt"
			columnName="somma_versamenti" newDataType="numeric" />
	</changeSet>

	<changeSet author="liquibase" id="20250704163950">
		<modifyDataType schemaName="${schema}"
			tableName="rt_versamenti" columnName="importo_rt"
			newDataType="numeric" />
		<modifyDataType schemaName="${schema}"
			tableName="rt_versamenti" columnName="commissione_applicate_psp"
			newDataType="numeric" />
		<modifyDataType schemaName="${schema}"
			tableName="rt_versamenti" columnName="commissione_carico_pa"
			newDataType="numeric" />
		<modifyDataType schemaName="${schema}"
			tableName="rt_versamenti" columnName="commissione_applicate_pa"
			newDataType="numeric" />
	</changeSet>
	
	    <changeSet author="liquibase" id="20250708162200">
        <createView replaceIfExists="true" viewName="V_POSITION_TRANSFER">
            SELECT ID, NOTICE_ID, CREDITOR_REFERENCE_ID, PA_FISCAL_CODE, PA_FISCAL_CODE_SECONDARY, IBAN, AMOUNT, REMITTANCE_INFORMATION, TRANSFER_CATEGORY, TRANSFER_IDENTIFIER, VALID, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP, FK_PAYMENT_PLAN, FK_POSITION_PAYMENT, INSERTED_BY, UPDATED_BY, METADATA, REQ_TIPO_BOLLO, REQ_HASH_DOCUMENTO, REQ_PROVINCIA_RESIDENZA
            FROM ${schemaOnline}.POSITION_TRANSFER
        </createView>
    </changeSet>
    
        <changeSet author="liquibase" id="20250708162201">
        <createView fullDefinition="true" viewName="V_RT_VERSAMENTI">CREATE OR REPLACE VIEW ${schema}.V_RT_VERSAMENTI(ID,PROGRESSIVO,IMPORTO_RT,ESITO,CAUSALE_VERSAMENTO,DATI_SPECIFICI_RISCOSSIONE,COMMISSIONE_APPLICATE_PSP,FK_RT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP) AS SELECT ID,PROGRESSIVO,IMPORTO_RT,ESITO,CAUSALE_VERSAMENTO,DATI_SPECIFICI_RISCOSSIONE,COMMISSIONE_APPLICATE_PSP,FK_RT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.RT_VERSAMENTI</createView>
    </changeSet>
    
    <changeSet author="liquibase" id="20250708162210">
        <createView fullDefinition="true" viewName="V_PM_SESSION_DATA">CREATE OR REPLACE VIEW ${schema}.V_PM_SESSION_DATA (ID, ID_SESSIONE, TIPO, MOBILE_TOKEN, RRN, TIPO_INTERAZIONE, IMPORTO_TOTALE_PAGATO, ESITO_TRANSAZIONE_CARTA, CODICE_AUTORIZZATIVO, TIMESTAMP_OPERAZIONE, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP, MOTIVO_ANNULLAMENTO) AS SELECT ID,ID_SESSIONE,TIPO,MOBILE_TOKEN,RRN,TIPO_INTERAZIONE,IMPORTO_TOTALE_PAGATO,ESITO_TRANSAZIONE_CARTA,CODICE_AUTORIZZATIVO,TIMESTAMP_OPERAZIONE,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,MOTIVO_ANNULLAMENTO FROM  ${schemaOnline}.PM_SESSION_DATA</createView>
    </changeSet>
    
        <changeSet author="liquibase" id="20250708162220">
        <createView fullDefinition="true" viewName="V_RT">CREATE OR REPLACE VIEW ${schema}.V_RT(ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,COD_ESITO,ESITO,DATA_RICEVUTA,DATA_RICHIESTA,ID_RICEVUTA,ID_RICHIESTA,SOMMA_VERSAMENTI,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,CANALE) AS SELECT  ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,COD_ESITO,ESITO,DATA_RICEVUTA,DATA_RICHIESTA,ID_RICEVUTA,ID_RICHIESTA,SOMMA_VERSAMENTI,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,CANALE FROM  ${schemaOnline}.RT</createView>
    </changeSet>
    
        <changeSet author="liquibase" id="20250708162230">
        <createView fullDefinition="true" viewName="V_RPT">CREATE OR REPLACE VIEW ${schema}.V_RPT(ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,BIC_ADDEBITO,DATA_MSG_RICH,FLAG_CANC,IBAN_ADDEBITO,ID_MSG_RICH,STAZ_INTERMEDIARIOPA,INTERMEDIARIOPA,CANALE,PSP,INTERMEDIARIOPSP,TIPO_VERSAMENTO,NUM_VERSAMENTI,RT_SIGNATURE_CODE,SOMMA_VERSAMENTI,PARAMETRI_PROFILO_PAGAMENTO,FK_CARRELLO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,RICEVUTA_PM,WISP_2) AS SELECT  ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,BIC_ADDEBITO,DATA_MSG_RICH,FLAG_CANC,IBAN_ADDEBITO,ID_MSG_RICH,STAZ_INTERMEDIARIOPA,INTERMEDIARIOPA,CANALE,PSP,INTERMEDIARIOPSP,TIPO_VERSAMENTO,NUM_VERSAMENTI,RT_SIGNATURE_CODE,SOMMA_VERSAMENTI,PARAMETRI_PROFILO_PAGAMENTO,FK_CARRELLO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,RICEVUTA_PM,WISP_2 FROM  ${schemaOnline}.RPT</createView>
    </changeSet>
    
        <changeSet author="liquibase" id="20250708162240">
        <createView fullDefinition="true" viewName="V_RPT_VERSAMENTI">CREATE OR REPLACE VIEW ${schema}.V_RPT_VERSAMENTI (ID, PROGRESSIVO, IMPORTO, COMMISSIONE_CARICO_PA, IBAN, IBAN_APPOGGIO, BIC_ACCREDITO, BIC_APPOGGIO, CREDENZIALI_PAGATORE, CAUSALE_VERSAMENTO, TIPO_VERSAMENTO, DATI_SPECIFICI_RISCOSSIONE, FK_RPT, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP) AS SELECT ID,PROGRESSIVO,IMPORTO,COMMISSIONE_CARICO_PA,IBAN,IBAN_APPOGGIO,BIC_ACCREDITO,BIC_APPOGGIO,CREDENZIALI_PAGATORE,CAUSALE_VERSAMENTO,TIPO_VERSAMENTO,DATI_SPECIFICI_RISCOSSIONE,FK_RPT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.RPT_VERSAMENTI</createView>
    </changeSet>
    
      <changeSet author="liquibase" id="20250708162250">
    <createView fullDefinition="true" viewName="PM_SESSION_DATA">CREATE OR REPLACE VIEW ${schema}.PM_SESSION_DATA (ID, ID_SESSIONE, TIPO, MOBILE_TOKEN, RRN, TIPO_INTERAZIONE, IMPORTO_TOTALE_PAGATO, ESITO_TRANSAZIONE_CARTA, CODICE_AUTORIZZATIVO, TIMESTAMP_OPERAZIONE, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP, MOTIVO_ANNULLAMENTO) AS SELECT ID,ID_SESSIONE,TIPO,MOBILE_TOKEN,RRN,TIPO_INTERAZIONE,IMPORTO_TOTALE_PAGATO,ESITO_TRANSAZIONE_CARTA,CODICE_AUTORIZZATIVO,TIMESTAMP_OPERAZIONE,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,MOTIVO_ANNULLAMENTO FROM  ${schemaOnline}.PM_SESSION_DATA</createView>
  </changeSet>
  
    <changeSet author="liquibase" id="20250708162260">
    <createView fullDefinition="true" viewName="RPT_VERSAMENTI">CREATE OR REPLACE VIEW ${schema}.RPT_VERSAMENTI (ID, PROGRESSIVO, IMPORTO, COMMISSIONE_CARICO_PA, IBAN, IBAN_APPOGGIO, BIC_ACCREDITO, BIC_APPOGGIO, CREDENZIALI_PAGATORE, CAUSALE_VERSAMENTO, TIPO_VERSAMENTO, DATI_SPECIFICI_RISCOSSIONE, FK_RPT, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP) AS SELECT ID,PROGRESSIVO,IMPORTO,COMMISSIONE_CARICO_PA,IBAN,IBAN_APPOGGIO,BIC_ACCREDITO,BIC_APPOGGIO,CREDENZIALI_PAGATORE,CAUSALE_VERSAMENTO,TIPO_VERSAMENTO,DATI_SPECIFICI_RISCOSSIONE,FK_RPT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.RPT_VERSAMENTI</createView>
  </changeSet>
  
    <changeSet author="liquibase" id="20250708162300">
    <createView fullDefinition="true" viewName="RT">CREATE OR REPLACE VIEW ${schema}.RT(ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,COD_ESITO,ESITO,DATA_RICEVUTA,DATA_RICHIESTA,ID_RICEVUTA,ID_RICHIESTA,SOMMA_VERSAMENTI,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,CANALE) AS SELECT  ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,COD_ESITO,ESITO,DATA_RICEVUTA,DATA_RICHIESTA,ID_RICEVUTA,ID_RICHIESTA,SOMMA_VERSAMENTI,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,CANALE FROM  ${schemaOnline}.RT</createView>
  </changeSet>
  
    <changeSet author="liquibase" id="20250708162310">
    <createView fullDefinition="true" viewName="RPT">CREATE OR REPLACE VIEW ${schema}.RPT(ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,BIC_ADDEBITO,DATA_MSG_RICH,FLAG_CANC,IBAN_ADDEBITO,ID_MSG_RICH,STAZ_INTERMEDIARIOPA,INTERMEDIARIOPA,CANALE,PSP,INTERMEDIARIOPSP,TIPO_VERSAMENTO,NUM_VERSAMENTI,RT_SIGNATURE_CODE,SOMMA_VERSAMENTI,PARAMETRI_PROFILO_PAGAMENTO,FK_CARRELLO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,RICEVUTA_PM,WISP_2) AS SELECT  ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,BIC_ADDEBITO,DATA_MSG_RICH,FLAG_CANC,IBAN_ADDEBITO,ID_MSG_RICH,STAZ_INTERMEDIARIOPA,INTERMEDIARIOPA,CANALE,PSP,INTERMEDIARIOPSP,TIPO_VERSAMENTO,NUM_VERSAMENTI,RT_SIGNATURE_CODE,SOMMA_VERSAMENTI,PARAMETRI_PROFILO_PAGAMENTO,FK_CARRELLO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,RICEVUTA_PM,WISP_2 FROM  ${schemaOnline}.RPT</createView>
  </changeSet>
  
    <changeSet author="liquibase" id="20250708162320">
    <createView fullDefinition="true" viewName="RT_VERSAMENTI">CREATE OR REPLACE VIEW ${schema}.RT_VERSAMENTI(ID,PROGRESSIVO,IMPORTO_RT,ESITO,CAUSALE_VERSAMENTO,DATI_SPECIFICI_RISCOSSIONE,COMMISSIONE_APPLICATE_PSP,FK_RT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP) AS SELECT ID,PROGRESSIVO,IMPORTO_RT,ESITO,CAUSALE_VERSAMENTO,DATI_SPECIFICI_RISCOSSIONE,COMMISSIONE_APPLICATE_PSP,FK_RT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.RT_VERSAMENTI</createView>
  </changeSet>

</databaseChangeLog>
