<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.6.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd"
                    >

    <changeSet author="liquibase" id="1666281309642-28">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="BINARY_FILE_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-29">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="ELENCO_SERVIZI_PA_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-30">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="ELENCO_SERVIZI_PA_SYNC_STATUS_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-31">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="ELENCO_SERVIZI_PSP_LOGOS_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-32">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="FATTURAZIONI_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-33">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="FLUSSI_RT_NEGATIVE_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-34">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="QUADRATURA_FLUSSI_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-35">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="QUADRATURE_RPT_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-36">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="QUADRATURE_RT_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-37">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="RENDICONTAZIONE_BOLLO_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-38">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="RENDICONTAZIONE_BOLLO_VERSAMENTO_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-39">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="RENDICONTAZIONE_SEQ" startValue="178721845"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-40">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="RENDICONTAZIONE_SFTP_RECEIVE_QUEUE_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-41">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="RENDICONTAZIONE_SFTP_SEND_QUEUE_SEQ" startValue="248241699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-42">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="SCHEDULER_FIRE_CHECK_SEQ" startValue="248301699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-43">
        <createSequence cacheSize="20000" maxValue="9223372036854775807" sequenceName="SCHEDULER_TRACE_SEQ" startValue="248361699"/>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-1">
        <createView fullDefinition="true" viewName="V_STATI_RPT">CREATE OR REPLACE VIEW ${schema}.V_STATI_RPT (ID, ID_SESSIONE, ID_SESSIONE_ORIGINALE, ID_DOMINIO, IUV, CCP, STATO, INSERTED_BY, INSERTED_TIMESTAMP) AS SELECT ID,ID_SESSIONE,ID_SESSIONE_ORIGINALE,ID_DOMINIO,IUV,CCP,STATO,INSERTED_BY,INSERTED_TIMESTAMP FROM  ${schemaOnline}.STATI_RPT</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-2">
        <createView fullDefinition="true" viewName="V_RPT_VERSAMENTI_BOLLO">CREATE OR REPLACE VIEW ${schema}.V_RPT_VERSAMENTI_BOLLO (ID, PROGRESSIVO, TIPO_BOLLO, HASH_DOCUMENTO, PROVINCIA_RESIDENZA, FK_RPT_VERSAMENTI, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP) AS SELECT ID,PROGRESSIVO,TIPO_BOLLO,HASH_DOCUMENTO,PROVINCIA_RESIDENZA,FK_RPT_VERSAMENTI,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.RPT_VERSAMENTI_BOLLO</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-3">
        <createView fullDefinition="true" viewName="V_CARRELLO">CREATE OR REPLACE VIEW ${schema}.V_CARRELLO (ID, ID_SESSIONE, DATA_MSG_RICH, ID_CARRELLO, STAZ_INTERMEDIARIOPA, INTERMEDIARIOPA, CANALE, PSP, INTERMEDIARIOPSP, TIPO_VERSAMENTO, PARAMETRI_PROFILO_PAGAMENTO, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP) AS SELECT ID,ID_SESSIONE,DATA_MSG_RICH,ID_CARRELLO,STAZ_INTERMEDIARIOPA,INTERMEDIARIOPA,CANALE,PSP,INTERMEDIARIOPSP,TIPO_VERSAMENTO,PARAMETRI_PROFILO_PAGAMENTO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.CARRELLO</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-4">
        <createView fullDefinition="true" viewName="V_RPT_XML" schemaName="${schema}">CREATE OR REPLACE VIEW ${schema}.V_RPT_XML (ID, CCP, IDENT_DOMINIO, IUV, FK_RPT, FK_CARRELLO, ID_SESSIONE, ID_CARRELLO, XML_CONTENT, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP) AS select ID,CCP,IDENT_DOMINIO,IUV,FK_RPT,FK_CARRELLO,ID_SESSIONE,ID_CARRELLO,XML_CONTENT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP from  ${schemaOnline}.RPT_XML</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-5">
        <createView fullDefinition="true" viewName="V_RPT_VERSAMENTI">CREATE OR REPLACE VIEW ${schema}.V_RPT_VERSAMENTI (ID, PROGRESSIVO, IMPORTO, COMMISSIONE_CARICO_PA, IBAN, IBAN_APPOGGIO, BIC_ACCREDITO, BIC_APPOGGIO, CREDENZIALI_PAGATORE, CAUSALE_VERSAMENTO, TIPO_VERSAMENTO, DATI_SPECIFICI_RISCOSSIONE, FK_RPT, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP) AS SELECT ID,PROGRESSIVO,IMPORTO,COMMISSIONE_CARICO_PA,IBAN,IBAN_APPOGGIO,BIC_ACCREDITO,BIC_APPOGGIO,CREDENZIALI_PAGATORE,CAUSALE_VERSAMENTO,TIPO_VERSAMENTO,DATI_SPECIFICI_RISCOSSIONE,FK_RPT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.RPT_VERSAMENTI</createView>
    </changeSet>
<!--    <changeSet author="liquibase" id="1666281309642-6">-->
<!--        <createView fullDefinition="true" viewName="V_REVOCA_RICHIESTE">CREATE OR REPLACE VIEW ${schema}.V_REVOCA_RICHIESTE (ID, ID_MESSAGGIO_REVOCA, DATA_ORA_REVOCA, STATO_RICHIESTA, IDENT_DOMINIO, IUV, CCP, INTERMEDIARIOPA, STAZ_INTERMEDIARIOPA, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP, INTERMEDIARIOPSP, CANALE, TIPO_REVOCA) AS SELECT ID,ID_MESSAGGIO_REVOCA,DATA_ORA_REVOCA,STATO_RICHIESTA,IDENT_DOMINIO,IUV,CCP,INTERMEDIARIOPA,STAZ_INTERMEDIARIOPA,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,INTERMEDIARIOPSP,CANALE,TIPO_REVOCA FROM  ${schemaOnline}.REVOCA_RICHIESTE</createView>-->
<!--    </changeSet>-->
    <changeSet author="liquibase" id="1666281309642-7">
        <createView fullDefinition="true" viewName="V_PM_SESSION_DATA">CREATE OR REPLACE VIEW ${schema}.V_PM_SESSION_DATA (ID, ID_SESSIONE, TIPO, MOBILE_TOKEN, RRN, TIPO_INTERAZIONE, IMPORTO_TOTALE_PAGATO, ESITO_TRANSAZIONE_CARTA, CODICE_AUTORIZZATIVO, TIMESTAMP_OPERAZIONE, INSERTED_TIMESTAMP, UPDATED_TIMESTAMP, MOTIVO_ANNULLAMENTO) AS SELECT ID,ID_SESSIONE,TIPO,MOBILE_TOKEN,RRN,TIPO_INTERAZIONE,IMPORTO_TOTALE_PAGATO,ESITO_TRANSAZIONE_CARTA,CODICE_AUTORIZZATIVO,TIMESTAMP_OPERAZIONE,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,MOTIVO_ANNULLAMENTO FROM  ${schemaOnline}.PM_SESSION_DATA</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-8">
        <createView fullDefinition="true" viewName="V_RPT_SOGGETTI">CREATE OR REPLACE VIEW ${schema}.V_RPT_SOGGETTI(RPT_ID,TIPO_SOGGETTO,TIPO_IDENTIFICATIVO_UNIVOCO,CODICE_IDENTIFICATIVO_UNIVOCO,ANAGRAFICA,INDIRIZZO,CIVICO,CAP,LOCALITA,PROVINCIA,NAZIONE,EMAIL,CODICE_UNITOPER,DENOMIN_UNITOPER,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP) AS SELECT RPT_ID,TIPO_SOGGETTO,TIPO_IDENTIFICATIVO_UNIVOCO,CODICE_IDENTIFICATIVO_UNIVOCO,ANAGRAFICA,INDIRIZZO,CIVICO,CAP,LOCALITA,PROVINCIA,NAZIONE,EMAIL,CODICE_UNITOPER,DENOMIN_UNITOPER,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.RPT_SOGGETTI</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-9">
        <createView fullDefinition="true" viewName="V_STATI_CARRELLO">CREATE OR REPLACE VIEW ${schema}.V_STATI_CARRELLO(ID_SESSIONE,ID_CARRELLO,STATO,INSERTED_BY,INSERTED_TIMESTAMP,ID_SESSIONE_ORIGINALE,ID) AS SELECT  ID_SESSIONE,ID_CARRELLO,STATO,INSERTED_BY,INSERTED_TIMESTAMP,ID_SESSIONE_ORIGINALE,ID FROM  ${schemaOnline}.STATI_CARRELLO</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-10">
        <createView fullDefinition="true" viewName="V_STATI_CARRELLO_SNAPSHOT">CREATE OR REPLACE VIEW ${schema}.V_STATI_CARRELLO_SNAPSHOT(ID_SESSIONE,ID_CARRELLO,STATO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,INSERTED_BY,UPDATED_BY) AS SELECT  ID_SESSIONE,ID_CARRELLO,STATO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,INSERTED_BY,UPDATED_BY FROM  ${schemaOnline}.STATI_CARRELLO_SNAPSHOT</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-11">
        <createView fullDefinition="true" viewName="V_RT_VERSAMENTI">CREATE OR REPLACE VIEW ${schema}.V_RT_VERSAMENTI(ID,PROGRESSIVO,IMPORTO_RT,ESITO,CAUSALE_VERSAMENTO,DATI_SPECIFICI_RISCOSSIONE,COMMISSIONE_APPLICATE_PSP,FK_RT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP) AS SELECT ID,PROGRESSIVO,IMPORTO_RT,ESITO,CAUSALE_VERSAMENTO,DATI_SPECIFICI_RISCOSSIONE,COMMISSIONE_APPLICATE_PSP,FK_RT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.RT_VERSAMENTI</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-12">
        <createTable tableName="RENDICONTAZIONE">
            <column defaultValueSequenceNext="RENDICONTAZIONE_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="RENDICONTAZIONE_PK"/>
            </column>
            <column name="OPTLOCK" type="NUMBER(19, 0)">
                <constraints nullable="false"/>
            </column>
            <column name="PSP" type="VARCHAR2(255 )">
                <constraints nullable="false"/>
            </column>
            <column name="INTERMEDIARIO" type="VARCHAR2(255 )"/>
            <column name="CANALE" type="VARCHAR2(255 )"/>
            <column name="PASSWORD" type="VARCHAR2(255 )"/>
            <column name="DOMINIO" type="VARCHAR2(255 )">
                <constraints nullable="false"/>
            </column>
            <column name="ID_FLUSSO" type="VARCHAR2(255 )">
                <constraints nullable="false"/>
            </column>
            <column name="DATA_ORA_FLUSSO" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="FK_BINARY_FILE" type="NUMBER(19, 0)"/>
            <column name="FK_SFTP_FILE" type="NUMBER(19, 0)"/>
            <column defaultValue="TO_BE_VALIDATED" name="STATO" type="VARCHAR2(255 )">
                <constraints nullable="false"/>
            </column>
            <column defaultValueSequenceNext="CURRENT_TIMESTAMP" name="INSERTED_TIMESTAMP" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-13">
        <createTable tableName="BINARY_FILE">
            <column defaultValueSequenceNext="BINARY_FILE_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="BINARY_FILE_PK"/>
            </column>
            <column name="FILE_SIZE" type="NUMBER(19, 0)"/>
            <column name="FILE_CONTENT" type="BYTEA"/>
            <column name="FILE_HASH" type="BYTEA"/>
            <column name="SIGNATURE_TYPE" type="VARCHAR2(30 )"/>
            <column name="XML_FILE_CONTENT" type="CLOB"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-44">
        <createTable tableName="CATALOGO_DATI">
            <column name="NAME" type="VARCHAR2(100 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="CONTENT" type="BYTEA">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-45">
        <createTable tableName="ELENCO_SERVIZI_PA">
            <column defaultValueSequenceNext="ELENCO_SERVIZI_PA_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="ELENCO_SERVIZI_PA_PK"/>
            </column>
            <column name="FK_SNAPSHOT_VERSION" type="NUMBER(19, 0)"/>
            <column name="IBAN_ACCREDITO" type="CHAR(35 )"/>
            <column name="ID_SELLER_BANK" type="CHAR(50 )"/>
            <column name="ID_NEGOZIO" type="CHAR(15 )"/>
            <column name="DATA_ATTIVAZIONE_IBAN" type="TIMESTAMP(6)"/>
            <column name="DATA_PUBBLICAZIONE" type="TIMESTAMP(6)"/>
            <column name="ID_DOMINIO" type="CHAR(35 )"/>
            <column name="RAGIONE_SOCIALE" type="CHAR(70 )"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-46">
        <createTable tableName="ELENCO_SERVIZI_PA_SYNC_STATUS">
            <column defaultValueSequenceNext="ELENCO_SERVIZI_PA_SYNC_STATUS_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="ELENCO_SERVIZI_PA_SYNK_STATUS_PK"/>
            </column>
            <column name="SNAPSHOT_VERSION" type="NUMBER(19, 0)"/>
            <column name="STATUS" type="CHAR(1 )">
                <constraints nullable="false"/>
            </column>
            <column name="TIMESTAMP_SNAPSHOT" type="TIMESTAMP(6)"/>
            <column name="STATUS_WRITE_DATA" type="CHAR(1 )">
                <constraints nullable="false"/>
            </column>
            <column name="STATUS_SYNC_WISP" type="CHAR(1 )">
                <constraints nullable="false"/>
            </column>
            <column name="JSON_WISP" type="CLOB"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-47">
        <createTable tableName="ELENCO_SERVIZI_PSP">
            <column name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="ELENCO_SERVIZI_PSP_PK"/>
            </column>
            <column name="FK_SNAPSHOT_VERSION" type="NUMBER(19, 0)">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="ELENCO_SERVIZI_PSP_PK"/>
            </column>
            <column name="PSP_ID" type="CHAR(35 )">
                <constraints nullable="false"/>
            </column>
            <column name="FLUSSO_ID" type="CHAR(35 )"/>
            <column name="PSP_RAG_SOC" type="CHAR(70)"/>
            <column name="PSP_FLAG_STORNO" type="CHAR(1)">
                <constraints nullable="false"/>
            </column>
            <column name="PSP_FLAG_BOLLO" type="CHAR(1)">
                <constraints nullable="false"/>
            </column>
            <column name="INTM_ID" type="CHAR(35)"/>
            <column name="CANALE_ID" type="CHAR(35)"/>
            <column name="NOME_SERVIZIO" type="CHAR(35)"/>
            <column name="CANALE_MOD_PAG" type="CHAR(35)"/>
            <column name="TIPO_VERS_COD" type="CHAR(35)"/>
            <column name="CODICE_LINGUA" type="CHAR(2 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="INF_COND_EC_MAX" type="CHAR(35)"/>
            <column name="INF_DESC_SERV" type="CHAR(511)"/>
            <column name="INF_DISP_SERV" type="CHAR(511)"/>
            <column name="INF_URL_CANALE" type="CHAR(255)"/>
            <column name="IMPORTO_MINIMO" type="NUMBER(19, 2)"/>
            <column name="IMPORTO_MASSIMO" type="NUMBER(19, 2)"/>
            <column name="COSTO_FISSO" type="NUMBER(19, 2)"/>
            <column name="TIMESTAMP_INS" type="TIMESTAMP(6)"/>
            <column name="DATA_VALIDITA" type="TIMESTAMP(6)"/>
            <column name="LOGO_PSP" type="BYTEA"/>
            <column name="TAGS" type="CHAR(135)"/>
            <column name="LOGO_SERVIZIO" type="BYTEA"/>
            <column name="CANALE_APP" type="CHAR(1)">
                <constraints nullable="false"/>
            </column>
            <column name="ON_US" type="CHAR(1)">
                <constraints nullable="false"/>
            </column>
            <column name="CARRELLO_CARTE" type="CHAR(1)">
                <constraints nullable="false"/>
            </column>
            <column name="CODICE_ABI" type="CHAR(5)"/>
            <column name="CODICE_MYBANK" type="VARCHAR2(35)"/>
            <column name="CODICE_CONVENZIONE" type="VARCHAR2(35)"/>
            <column defaultValue="N" name="FLAG_IO" type="CHAR(1 BYTE)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-48">
        <createTable tableName="ELENCO_SERVIZI_PSP_LOGOS">
            <column defaultValueSequenceNext="ELENCO_SERVIZI_PSP_LOGOS_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="ELENCO_SERVIZI_PSP_LOGOS_PK"/>
            </column>
            <column name="FILE_SIZE" type="NUMBER(19, 0)"/>
            <column name="LOGO" type="BYTEA"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-49">
        <createTable tableName="ELENCO_SERVIZI_PSP_SYNC_STATUS">
            <column name="SNAPSHOT_VERSION" type="NUMBER(19, 0)">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="ELENCO_SERVIZI_PSP_SYNC_STATUS_PK"/>
            </column>
            <column name="VALID" type="CHAR(1)">
                <constraints nullable="false"/>
            </column>
            <column name="TIMESTAMP_SNAPSHOT" type="TIMESTAMP(6)"/>
            <column name="STATUS_WRITE_DATA" type="CHAR(1)">
                <constraints nullable="false"/>
            </column>
            <column name="STATUS_SYNC_WISP" type="CHAR(1)">
                <constraints nullable="false"/>
            </column>
            <column name="STATUS_SYNC_PM" type="CHAR(1)">
                <constraints nullable="false"/>
            </column>
            <column name="JSON_PM" type="CLOB"/>
            <column name="JSON_WISP" type="CLOB"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-50">
        <createTable tableName="FATTURAZIONI">
            <column defaultValueSequenceNext="FATTURAZIONI_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="FATTURAZIONI_PK"/>
            </column>
            <column name="SESSION_ID" type="VARCHAR2(255)">
                <constraints nullable="false"/>
            </column>
            <column name="FILE_NAME" type="VARCHAR2(255)">
                <constraints nullable="false"/>
            </column>
            <column name="CONTENT" type="BYTEA"/>
            <column name="DAY" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="INSERTED_TIMESTAMP" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="UPLOADED" type="NUMBER(1, 0)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-51">
        <createTable tableName="FATTURAZIONI_PSP_AGGR">
            <column name="SESSION_ID" type="VARCHAR2(255 BYTE)"/>
            <column name="DAY" type="date"/>
            <column name="PSP" type="VARCHAR2(35 BYTE)"/>
            <column name="OK" type="NUMBER(22, 0)"/>
            <column name="IMPORTO_OK" type="FLOAT(22)"/>
            <column name="POS" type="NUMBER(22, 0)"/>
            <column name="IMPORTO_POS" type="FLOAT(22)"/>
            <column name="COD9" type="NUMBER(22, 0)"/>
            <column name="IMPORTO_COD9" type="FLOAT(22)"/>
            <column name="KO" type="NUMBER(22, 0)"/>
            <column name="IMPORTO_KO" type="FLOAT(22)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-52">
        <createTable tableName="FLUSSI_RT_NEGATIVE">
            <column defaultValueSequenceNext="FLUSSI_RT_NEGATIVE_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="FLUS_RT_NEG_PK"/>
            </column>
            <column name="SESSION_ID" type="VARCHAR2(255)">
                <constraints nullable="false"/>
            </column>
            <column name="FILE_NAME" type="VARCHAR2(255)">
                <constraints nullable="false"/>
            </column>
            <column name="CONTENT" type="BYTEA"/>
            <column name="DAY" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="INSERTED_TIMESTAMP" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="UPLOADED" type="NUMBER(1, 0)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-53">
        <createTable tableName="QUADRATURA_FLUSSI">
            <column defaultValueSequenceNext="QUADRATURA_FLUSSI_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="QUADRATURA_FLUSSI_PK"/>
            </column>
            <column name="VERSIONE_OGGETTO" type="VARCHAR2(50)"/>
            <column name="SOGGETTO_RICHIEDENTE" type="VARCHAR2(50)"/>
            <column name="SOGGETTO_REALE" type="VARCHAR2(35)"/>
            <column name="DATA_INIZIO_PERIODO" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="DATA_FINE_PERIODO" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="ID_FLUSSO" type="VARCHAR2(35)"/>
            <column name="DATA_ORA_FLUSSO" type="TIMESTAMP(6)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-54">
        <createTable tableName="QUADRATURE_RPT">
            <column defaultValueSequenceNext="QUADRATURE_RPT_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="QUADRATURE_RPT_PK"/>
            </column>
            <column name="ID_FLUSSO_QUADRATURA" type="NUMBER">
                <constraints nullable="false"/>
            </column>
            <column name="MITTENTE" type="VARCHAR2(35)"/>
            <column name="CANALE" type="VARCHAR2(35)"/>
            <column name="DESTINATARIO" type="VARCHAR2(35)"/>
            <column name="IMPORTI_ATTESA" type="FLOAT(22)"/>
            <column name="OGGETTI_ATTESA" type="NUMBER"/>
            <column name="IMPORTI_CONSEGNATE" type="FLOAT(22)"/>
            <column name="OGGETTI_CONSEGNATE" type="NUMBER"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-55">
        <createTable tableName="QUADRATURE_RT">
            <column defaultValueSequenceNext="QUADRATURE_RT_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="QUADRATURE_RT_PK"/>
            </column>
            <column name="ID_FLUSSO_QUADRATURA" type="NUMBER">
                <constraints nullable="false"/>
            </column>
            <column name="MITTENTE" type="VARCHAR2(35)"/>
            <column name="CANALE" type="VARCHAR2(35)"/>
            <column name="DESTINATARIO" type="VARCHAR2(35)"/>
            <column name="IMPORTI_ATTESA" type="FLOAT(22)"/>
            <column name="OGGETTI_ATTESA" type="NUMBER"/>
            <column name="IMPORTI_CONSEGNATE" type="FLOAT(22)"/>
            <column name="OGGETTI_CONSEGNATE" type="NUMBER"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-56">
        <createTable tableName="RENDICONTAZIONE_BOLLO">
            <column defaultValueSequenceNext="RENDICONTAZIONE_BOLLO_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="RENDICONTAZIONE_BOLLO_PK"/>
            </column>
            <column name="ID_DOMINIO" type="VARCHAR2(35)"/>
            <column name="RENDICONTAZIONE_BOLLO_PROGRESSIVE" type="NUMBER(19, 0)"/>
            <column defaultValue="TO_BE_VALIDATED" name="STATUS" type="VARCHAR2(255)">
                <constraints nullable="false"/>
            </column>
            <column name="FK_SFTP_FILE" type="NUMBER(19, 0)"/>
            <column name="FK_SFTP_FILE_ESITO" type="NUMBER(19, 0)"/>
            <column name="FILE_NAME" type="VARCHAR2(255)"/>
            <column name="FILE_NAME_ESITO" type="VARCHAR2(255)"/>
            <column name="TIMESTAMP_START_WEEK" type="TIMESTAMP(6)"/>
            <column name="TIMESTAMP_END_WEEK" type="TIMESTAMP(6)"/>
            <column name="TIMESTAMP_INS" type="TIMESTAMP(6)"/>
            <column name="TIMESTAMP_RICEZIONE_ESITO" type="TIMESTAMP(6)"/>
            <column name="TIMESTAMP_INVIO_FLUSSO_MARCHE_DIGITALI" type="TIMESTAMP(6)"/>
            <column name="TIMESTAMP_DATA_ESITO_FLUSSO" type="TIMESTAMP(6)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-57">
        <createTable tableName="RENDICONTAZIONE_BOLLO_VERSAMENTO">
            <column name="FK_VERSAMENTO_BOLLO" type="NUMBER(19, 0)"/>
            <column name="FK_RENDICONTAZIONE_BOLLO" type="NUMBER(19, 0)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-58">
        <createTable tableName="RENDICONTAZIONE_SFTP_RECEIVE_QUEUE">
            <column defaultValueSequenceNext="RENDICONTAZIONE_SFTP_RECEIVE_QUEUE_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="RENDICONTAZIONE_SFTP_RECEIVE_QUEUE_PK"/>
            </column>
            <column name="FILE_NAME" type="VARCHAR2(255)">
                <constraints nullable="false"/>
            </column>
            <column name="STATUS" type="VARCHAR2(10)">
                <constraints nullable="false"/>
            </column>
            <column name="FILE_SIZE" type="NUMBER(19, 0)"/>
            <column name="SERVER_ID" type="NUMBER(19, 0)">
                <constraints nullable="false"/>
            </column>
            <column name="HOST_NAME" type="VARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
            <column name="PORT" type="NUMBER(19, 0)">
                <constraints nullable="false"/>
            </column>
            <column name="PATH" type="VARCHAR2(255)">
                <constraints nullable="false"/>
            </column>
            <column name="HASH" type="VARCHAR2(32)">
                <constraints nullable="false"/>
            </column>
            <column name="CONTENT" type="BYTEA">
                <constraints nullable="false"/>
            </column>
            <column name="SENDER" type="VARCHAR2(50)"/>
            <column name="RECEIVER" type="VARCHAR2(50)"/>
            <column name="INSERTED_TIMESTAMP" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="UPDATED_TIMESTAMP" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="INSERTED_BY" type="VARCHAR2(35)">
                <constraints nullable="false"/>
            </column>
            <column name="UPDATED_BY" type="VARCHAR2(35)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-59">
        <createTable tableName="RENDICONTAZIONE_SFTP_SEND_QUEUE">
            <column defaultValueSequenceNext="RENDICONTAZIONE_SFTP_SEND_QUEUE_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="RENDICONTAZIONE_SFTP_SEND_QUEUE_PK"/>
            </column>
            <column name="FILE_NAME" type="VARCHAR2(255)">
                <constraints nullable="false"/>
            </column>
            <column name="STATUS" type="VARCHAR2(10)">
                <constraints nullable="false"/>
            </column>
            <column name="FILE_SIZE" type="NUMBER(19, 0)"/>
            <column name="SERVER_ID" type="NUMBER(19, 0)">
                <constraints nullable="false"/>
            </column>
            <column name="HOST_NAME" type="VARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
            <column name="PORT" type="NUMBER(19, 0)">
                <constraints nullable="false"/>
            </column>
            <column name="PATH" type="VARCHAR2(255)">
                <constraints nullable="false"/>
            </column>
            <column name="HASH" type="VARCHAR2(32)">
                <constraints nullable="false"/>
            </column>
            <column name="CONTENT" type="BYTEA">
                <constraints nullable="false"/>
            </column>
            <column name="SENDER" type="VARCHAR2(50)"/>
            <column name="RECEIVER" type="VARCHAR2(50)"/>
            <column name="INSERTED_TIMESTAMP" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="UPDATED_TIMESTAMP" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="INSERTED_BY" type="VARCHAR2(35)">
                <constraints nullable="false"/>
            </column>
            <column name="UPDATED_BY" type="VARCHAR2(35)">
                <constraints nullable="false"/>
            </column>
            <column name="RETRY" type="NUMBER(19, 0)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-60" objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">
        <createTable tableName="SCHEDULER_FIRE_CHECK">
            <column defaultValueSequenceNext="SCHEDULER_FIRE_CHECK_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="SCHEDULER_FIRE_CHECK_PK"/>
            </column>
            <column name="JOB_NAME" type="VARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
            <column name="EXTRA_KEY" type="VARCHAR2(500)">
                <constraints nullable="false"/>
            </column>
            <column name="START" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="STATUS" type="VARCHAR2(50)"/>
            <column name="end" type="TIMESTAMP(6)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-61">
        <createTable tableName="SCHEDULER_TRACE">
            <column defaultValueSequenceNext="SCHEDULER_TRACE_SEQ" name="ID" type="NUMBER">
                <constraints nullable="false" primaryKey="true"  primaryKeyName="SCHEDULER_TRACE_PK"/>
            </column>
            <column name="ID_SESSIONE" type="VARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
            <column name="JOB_NAME" type="VARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
            <column name="START" type="TIMESTAMP(6)">
                <constraints nullable="false"/>
            </column>
            <column name="FIRE" type="VARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
            <column name="CRON" type="VARCHAR2(50)"/>
            <column name="STATUS" type="VARCHAR2(50)"/>
            <column name="MESSAGE" type="VARCHAR2(1024)"/>
        </createTable>
    </changeSet>
<!--    <changeSet author="liquibase" id="1666281309642-14">-->
<!--        <createView fullDefinition="true" viewName="V_STORNO_RICHIESTE">CREATE OR REPLACE VIEW ${schema}.V_STORNO_RICHIESTE(ID,ID_MESSAGGIO_REVOCA,DATA_ORA_REVOCA,STATO_RICHIESTA,IDENT_DOMINIO,IUV,CCP,INTERMEDIARIOPA,STAZ_INTERMEDIARIOPA,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP) AS SELECT  ID,ID_MESSAGGIO_REVOCA,DATA_ORA_REVOCA,STATO_RICHIESTA,IDENT_DOMINIO,IUV,CCP,INTERMEDIARIOPA,STAZ_INTERMEDIARIOPA,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.STORNO_RICHIESTE</createView>-->
<!--    </changeSet>-->
    <changeSet author="liquibase" id="1666281309642-15">
        <createView fullDefinition="true" viewName="V_RT">CREATE OR REPLACE VIEW ${schema}.V_RT(ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,COD_ESITO,ESITO,DATA_RICEVUTA,DATA_RICHIESTA,ID_RICEVUTA,ID_RICHIESTA,SOMMA_VERSAMENTI,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,CANALE) AS SELECT  ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,COD_ESITO,ESITO,DATA_RICEVUTA,DATA_RICHIESTA,ID_RICEVUTA,ID_RICHIESTA,SOMMA_VERSAMENTI,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,CANALE FROM  ${schemaOnline}.RT</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-16">
        <createView fullDefinition="true" viewName="V_STATI_RPT_SNAPSHOT">CREATE OR REPLACE VIEW ${schema}.V_STATI_RPT_SNAPSHOT(ID_DOMINIO,IUV,CCP,ID_SESSIONE,STATO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,INSERTED_BY,UPDATED_BY,PUSH) AS SELECT  ID_DOMINIO,IUV,CCP,ID_SESSIONE,STATO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,INSERTED_BY,UPDATED_BY,PUSH FROM  ${schemaOnline}.STATI_RPT_SNAPSHOT</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-17">
        <createView fullDefinition="true" viewName="V_RPT">CREATE OR REPLACE VIEW ${schema}.V_RPT(ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,BIC_ADDEBITO,DATA_MSG_RICH,FLAG_CANC,IBAN_ADDEBITO,ID_MSG_RICH,STAZ_INTERMEDIARIOPA,INTERMEDIARIOPA,CANALE,PSP,INTERMEDIARIOPSP,TIPO_VERSAMENTO,NUM_VERSAMENTI,RT_SIGNATURE_CODE,SOMMA_VERSAMENTI,PARAMETRI_PROFILO_PAGAMENTO,FK_CARRELLO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,RICEVUTA_PM,WISP_2) AS SELECT  ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,BIC_ADDEBITO,DATA_MSG_RICH,FLAG_CANC,IBAN_ADDEBITO,ID_MSG_RICH,STAZ_INTERMEDIARIOPA,INTERMEDIARIOPA,CANALE,PSP,INTERMEDIARIOPSP,TIPO_VERSAMENTO,NUM_VERSAMENTI,RT_SIGNATURE_CODE,SOMMA_VERSAMENTI,PARAMETRI_PROFILO_PAGAMENTO,FK_CARRELLO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,RICEVUTA_PM,WISP_2 FROM  ${schemaOnline}.RPT</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-18">
        <createView fullDefinition="true" viewName="V_RT_XML">CREATE OR REPLACE VIEW ${schema}.V_RT_XML(ID,CCP,IDENT_DOMINIO,IUV,FK_RT,TIPO_FIRMA,XML_CONTENT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,ID_SESSIONE) AS SELECT  ID,CCP,IDENT_DOMINIO,IUV,FK_RT,TIPO_FIRMA,XML_CONTENT,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,ID_SESSIONE FROM  ${schemaOnline}.RT_XML</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-19">
        <createView fullDefinition="true" viewName="V_RT_VERSAMENTI_BOLLO">CREATE OR REPLACE VIEW ${schema}.V_RT_VERSAMENTI_BOLLO(ID,PROGRESSIVO,TIPO_BOLLO,TIPO_ALLEGATO_RICEVUTA,IUBD,STATO,IMPORTO,ORA_ACQUISTO,FK_RT_VERSAMENTI,ACK_IMPRONTA,ACK_IUDB,ACK_CODICE_FISCALE,ACK_DENOMINAZIONE,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP) AS SELECT  ID,PROGRESSIVO,TIPO_BOLLO,TIPO_ALLEGATO_RICEVUTA,IUBD,STATO,IMPORTO,ORA_ACQUISTO,FK_RT_VERSAMENTI,ACK_IMPRONTA,ACK_IUDB,ACK_CODICE_FISCALE,ACK_DENOMINAZIONE,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.RT_VERSAMENTI_BOLLO</createView>
    </changeSet>
<!--    <changeSet author="liquibase" id="1666281309642-20">-->
<!--        <createView fullDefinition="true" viewName="V_STORNO_ESITI">CREATE OR REPLACE VIEW ${schema}.V_STORNO_ESITI(ID,ID_MESSAGGIO_ESITO,DATA_ORA_MESSAGGIO_ESITO,RIFERIMENTO_DATA_ORA_REVOCA,STATO_ESITO,RIFERIMENTO_MESSAGGIO_REVOCA,IDENT_DOMINIO,IUV,CCP,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP) AS SELECT  ID,ID_MESSAGGIO_ESITO,DATA_ORA_MESSAGGIO_ESITO,RIFERIMENTO_DATA_ORA_REVOCA,STATO_ESITO,RIFERIMENTO_MESSAGGIO_REVOCA,IDENT_DOMINIO,IUV,CCP,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.STORNO_ESITI</createView>-->
<!--    </changeSet>-->
<!--    <changeSet author="liquibase" id="1666281309642-21">-->
<!--        <createView fullDefinition="true" viewName="V_REVOCA_ESITI">CREATE OR REPLACE VIEW ${schema}.V_REVOCA_ESITI(ID,ID_MESSAGGIO_ESITO,DATA_ORA_MESSAGGIO_ESITO,RIFERIMENTO_DATA_ORA_REVOCA,STATO_ESITO,RIFERIMENTO_MESSAGGIO_REVOCA,IDENT_DOMINIO,IUV,CCP,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP) AS SELECT  ID,ID_MESSAGGIO_ESITO,DATA_ORA_MESSAGGIO_ESITO,RIFERIMENTO_DATA_ORA_REVOCA,STATO_ESITO,RIFERIMENTO_MESSAGGIO_REVOCA,IDENT_DOMINIO,IUV,CCP,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP FROM  ${schemaOnline}.REVOCA_ESITI</createView>-->
<!--    </changeSet>-->
    <changeSet author="liquibase" id="1666281309642-22">
        <createView fullDefinition="true" viewName="RGS_RENDICONTAZIONE">CREATE OR REPLACE VIEW ${schema}.RGS_RENDICONTAZIONE(DATA_ORA_FLUSSO,PSP,CANALE,ID_FLUSSO,DOMINIO,XML_FILE_CONTENT) AS SELECT
            RC.DATA_ORA_FLUSSO,
            RC.PSP,
            RC.CANALE,
            RC.ID_FLUSSO,
            RC.DOMINIO,
            BF.XML_FILE_CONTENT
            FROM ${schema}.RENDICONTAZIONE RC
            JOIN ${schema}.BINARY_FILE BF ON (RC.FK_BINARY_FILE=BF.ID)</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-23">
        <createView fullDefinition="true" viewName="RGS_RPT">
CREATE OR REPLACE VIEW ${schema}.RGS_RPT(STATI_TIMESTAMP,XML_TIMESTAMP,IUV,CCP,IDENT_DOMINIO,FK_CARRELLO,FK_RPT,STATO,XML_CONTENT) AS SELECT
            STATI.INSERTED_TIMESTAMP AS STATI_TIMESTAMP,
            RPTXML.INSERTED_TIMESTAMP AS XML_TIMESTAMP,
            RPTXML.IUV,
            RPTXML.CCP,
            RPTXML.IDENT_DOMINIO,
            RPTXML.FK_CARRELLO,
            RPTXML.FK_RPT,
            STATI.STATO,
            RPTXML.XML_CONTENT
            FROM ${schema}.V_RPT_XML RPTXML
            JOIN ${schema}.V_STATI_RPT STATI ON (RPTXML.CCP=STATI.CCP AND RPTXML.IDENT_DOMINIO=STATI.ID_DOMINIO AND RPTXML.IUV=STATI.IUV AND RPTXML.ID_SESSIONE=STATI.ID_SESSIONE)
            WHERE STATI.STATO IN ('RPT_ACCETTATA_PSP','RPT_RIFIUTATA_PSP')</createView>
    </changeSet>

    <changeSet author="liquibase" id="1666281309642-24">
        <createView fullDefinition="true" viewName="V_RGS_RENDICONTAZIONE">CREATE OR REPLACE VIEW ${schema}.V_RGS_RENDICONTAZIONE(TEXT,DATA_REPORT) AS SELECT
                                                                                REPLACE(
                                                                                  REPLACE('&lt;CONTAINER&gt;'||
                                                                                          REGEXP_REPLACE(XML_FILE_CONTENT, E'[\\n\\r]+', '', 'g')
                                                                                    || '&lt;/CONTAINER&gt;', chr(10), ''),
                                                                                  chr(13), '') || chr(13) as TEXT, DATA_ORA_FLUSSO AS DATA_REPORT FROM ${schema}.RGS_RENDICONTAZIONE
        </createView>
    </changeSet>

<!--    <changeSet author="liquibase" id="1666281309642-25">-->
<!--        <createView fullDefinition="true" viewName="TRANSAZIONI">CREATE OR REPLACE VIEW ${schema}.TRANSAZIONI(STATO,ID,ID_SESSIONE,IDENT_DOMINIO,IUV,CCP,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,PSP,INTERMEDIARIOPA,INTERMEDIARIOPSP,CANALE,TIPO_VERSAMENTO,RICEVUTA_PM,SOMMA_VERSAMENTI,FK_CARRELLO,ESITO,STAZ_INTERMEDIARIOPA,COD_ESITO) AS SELECT STATI.STATO, RPT.ID, RPT.ID_SESSIONE, RPT.IDENT_DOMINIO, RPT.IUV, RPT.CCP, RPT.INSERTED_TIMESTAMP, STATI.UPDATED_TIMESTAMP, RPT.PSP, RPT.INTERMEDIARIOPA,-->
<!--            RPT.INTERMEDIARIOPSP, RPT.CANALE, RPT.TIPO_VERSAMENTO, RPT.RICEVUTA_PM, RPT.SOMMA_VERSAMENTI, RPT.FK_CARRELLO, RT.ESITO, RPT.STAZ_INTERMEDIARIOPA, RT.COD_ESITO"-->
<!--            FROM ${schema}.RPT" RPT-->
<!--            LEFT JOIN ${schema}.RT" RT ON (RPT.IDENT_DOMINIO=RT.IDENT_DOMINIO" AND RPT.IUV=RT.IUV" AND RPT.CCP=RT.CCP)-->
<!--            JOIN ${schema}.STATI_RPT_SNAPSHOT" STATI ON (RPT.CCP=STATI.CCP" AND RPT.IDENT_DOMINIO=STATI.ID_DOMINIO" AND RPT.IUV=STATI.IUV" AND RPT.ID_SESSIONE=STATI.ID_SESSIONE)</createView>-->
<!--    </changeSet>-->
    <changeSet author="liquibase" id="1666281309642-26">
        <createView fullDefinition="true" viewName="RGS_RT">CREATE OR REPLACE VIEW ${schema}.RGS_RT(STATI_TIMESTAMP,XML_TIMESTAMP,IUV,CCP,IDENT_DOMINIO,STATO,FK_RT,XML_CONTENT) AS SELECT
            STATI.INSERTED_TIMESTAMP AS STATI_TIMESTAMP,
            RTXML.INSERTED_TIMESTAMP AS XML_TIMESTAMP,
            RTXML.IUV,
            RTXML.CCP,
            RTXML.IDENT_DOMINIO,
            STATI.STATO,
            RTXML.FK_RT,
            RTXML.XML_CONTENT
            FROM ${schemaOnline}.RT_XML RTXML
            JOIN ${schemaOnline}.STATI_RPT_SNAPSHOT STATI ON (RTXML.CCP=STATI.CCP AND RTXML.IDENT_DOMINIO=STATI.ID_DOMINIO AND RTXML.IUV=STATI.IUV )
            WHERE STATI.STATO IN ('RT_ACCETTATA_PA','RT_RIFIUTATA_PA')</createView>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-27">
        <createView fullDefinition="true" viewName="V_RGS_RT">CREATE OR REPLACE VIEW ${schema}.V_RGS_RT(TEXT,DATA_REPORT) AS SELECT REPLACE(REPLACE('&lt;CONTAINER&gt;'|| XML_CONTENT || '&lt;/CONTAINER&gt;', chr(10), ''), chr(13), '')||chr(13) as TEXT,
            STATI_TIMESTAMP AS DATA_REPORT
            FROM ${schema}.RGS_RT</createView>
    </changeSet>


    <changeSet author="liquibase" id="1666281309642-62">
        <createIndex indexName="ELENCO_SERVIZI_PSP_IDX1" tableName="ELENCO_SERVIZI_PSP">
            <column name="TIPO_VERS_COD"/>
            <column name="FK_SNAPSHOT_VERSION"/>
            <column name="CANALE_MOD_PAG"/>
            <column name="CANALE_APP"/>
            <column name="IMPORTO_MASSIMO"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-63">
        <createIndex indexName="RENDICONTAZIONE_IDX1" tableName="RENDICONTAZIONE">
            <column name="STATO"/>
            <column name="ID_FLUSSO"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-64">
        <createIndex indexName="REND_ELENCO_FLUSSI" tableName="RENDICONTAZIONE">
            <column name="STATO"/>
            <column name="DATA_ORA_FLUSSO"/>
            <column name="DOMINIO"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-65">
        <createIndex indexName="SCHEDULER_FIRE_CHECK_JOB_NAME_EXTRA_KEY_IDX" tableName="SCHEDULER_FIRE_CHECK">
            <column name="JOB_NAME"/>
            <column name="EXTRA_KEY"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-66">
        <createIndex indexName="SCHEDULER_TRACE_ID_SESSIONE_IDX" tableName="SCHEDULER_TRACE">
            <column name="ID_SESSIONE"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase" id="1666281309642-67">
        <addForeignKeyConstraint baseColumnNames="FK_RENDICONTAZIONE_BOLLO" baseTableName="RENDICONTAZIONE_BOLLO_VERSAMENTO" constraintName="FK_RENDICONTAZIONE_BOLLO" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="ID" referencedTableName="RENDICONTAZIONE_BOLLO" validate="true"/>
    </changeSet>
<!--    <changeSet author="liquibase" id="1666281309642-68">-->
<!--        <createView fullDefinition="true" viewName="QUAD_RPT">CREATE OR REPLACE VIEW ${schema}.QUAD_RPT(ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,BIC_ADDEBITO,DATA_MSG_RICH,FLAG_CANC,IBAN_ADDEBITO,ID_MSG_RICH,STAZ_INTERMEDIARIOPA,INTERMEDIARIOPA,CANALE,PSP,INTERMEDIARIOPSP,TIPO_VERSAMENTO,NUM_VERSAMENTI,RT_SIGNATURE_CODE,SOMMA_VERSAMENTI,PARAMETRI_PROFILO_PAGAMENTO,FK_CARRELLO,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,RICEVUTA_PM,WISP_2,STATO) AS SELECT RPT.ID,RPT.ID_SESSIONE,RPT.CCP,RPT.IDENT_DOMINIO,RPT.IUV,RPT.BIC_ADDEBITO,RPT.DATA_MSG_RICH,RPT.FLAG_CANC,RPT.IBAN_ADDEBITO,RPT.ID_MSG_RICH,RPT.STAZ_INTERMEDIARIOPA,RPT.INTERMEDIARIOPA,RPT.CANALE,RPT.PSP,RPT.INTERMEDIARIOPSP,RPT.TIPO_VERSAMENTO,RPT.NUM_VERSAMENTI,RPT.RT_SIGNATURE_CODE,RPT.SOMMA_VERSAMENTI,RPT.PARAMETRI_PROFILO_PAGAMENTO,RPT.FK_CARRELLO,RPT.INSERTED_TIMESTAMP,RPT.UPDATED_TIMESTAMP,RPT.RICEVUTA_PM,RPT.WISP_2, STATI.STATO FROM  ${schemaOnline}.RPT RPT-->
<!--            JOIN  ${schemaOnline}.STATI_RPT STATI ON (RPT.CCP=STATI.CCP AND RPT.IDENT_DOMINIO=STATI.ID_DOMINIO AND RPT.IUV=STATI.IUV AND RPT.ID_SESSIONE=STATI.ID_SESSIONE_ORIGINALE)-->
<!--            WHERE STATI.STATO IN ('RPT_ACCETTATA_PSP')-->
<!--            UNION All-->
<!--            SELECT RPT.ID,RPT.ID_SESSIONE,RPT.CCP,RPT.IDENT_DOMINIO,RPT.IUV,RPT.BIC_ADDEBITO,RPT.DATA_MSG_RICH,RPT.FLAG_CANC,RPT.IBAN_ADDEBITO,RPT.ID_MSG_RICH,RPT.STAZ_INTERMEDIARIOPA,RPT.INTERMEDIARIOPA,RPT.CANALE,RPT.PSP,RPT.INTERMEDIARIOPSP,RPT.TIPO_VERSAMENTO,RPT.NUM_VERSAMENTI,RPT.RT_SIGNATURE_CODE,RPT.SOMMA_VERSAMENTI,RPT.PARAMETRI_PROFILO_PAGAMENTO,RPT.FK_CARRELLO,RPT.INSERTED_TIMESTAMP,RPT.UPDATED_TIMESTAMP,RPT.RICEVUTA_PM,RPT.WISP_2, STATI.STATO FROM  ${schemaOnline}.RPT RPT-->
<!--            JOIN  ${schemaOnline}.STATI_RPT_SNAPSHOT STATI ON (RPT.CCP=STATI.CCP AND RPT.IDENT_DOMINIO=STATI.ID_DOMINIO AND RPT.IUV=STATI.IUV AND RPT.ID_SESSIONE=STATI.ID_SESSIONE)-->
<!--            WHERE STATI.STATO IN ('RPT_ESITO_SCONOSCIUTO_PSP','RPT_INVIATA_A_PSP')</createView>-->
<!--    </changeSet>-->
<!--    <changeSet author="liquibase" id="1666281309642-69">-->
<!--        <createView fullDefinition="true" viewName="QUAD_RT">CREATE OR REPLACE VIEW ${schema}.QUAD_RT(ID,ID_SESSIONE,CCP,IDENT_DOMINIO,IUV,COD_ESITO,ESITO,DATA_RICEVUTA,DATA_RICHIESTA,ID_RICEVUTA,ID_RICHIESTA,SOMMA_VERSAMENTI,INSERTED_TIMESTAMP,UPDATED_TIMESTAMP,CANALE,STATO) AS SELECT RT.ID,RT.ID_SESSIONE,RT.CCP,RT.IDENT_DOMINIO,RT.IUV,RT.COD_ESITO,RT.ESITO,RT.DATA_RICEVUTA,RT.DATA_RICHIESTA,RT.ID_RICEVUTA,RT.ID_RICHIESTA,RT.SOMMA_VERSAMENTI,RT.INSERTED_TIMESTAMP,RT.UPDATED_TIMESTAMP,RT.CANALE, STATI.STATO FROM  ${schemaOnline}.RT-->
<!--            JOIN  ${schemaOnline}.STATI_RPT_SNAPSHOT STATI ON (RT.CCP=STATI.CCP AND RT.IDENT_DOMINIO=STATI.ID_DOMINIO AND RT.IUV=STATI.IUV)-->
<!--            WHERE STATI.STATO IN ('RT_ACCETTATA_PA','RT_ESITO_SCONOSCIUTO_PA','RT_INVIATA_PA')</createView>-->
<!--    </changeSet>-->
    <changeSet author="liquibase" id="1666281309642-70">
        <createView fullDefinition="true" viewName="V_RGS_RPT">CREATE OR REPLACE VIEW ${schema}.V_RGS_RPT(TEXT,DATA_REPORT) AS SELECT
            REPLACE(REPLACE('&lt;CONTAINER&gt;'|| XML_CONTENT || '&lt;/CONTAINER&gt;', chr(10), ''), chr(13), '')||chr(13) as TEXT,
            STATI_TIMESTAMP AS DATA_REPORT
            FROM RGS_RPT</createView>
    </changeSet>
</databaseChangeLog>
